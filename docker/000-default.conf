<Directory /usr/local/elixir/http/>
    Options +ExecCGI
    AllowOverride None
    Require all granted
    SetEnv PYTHONIOENCODING utf-8
    SetEnv LXR_PROJ_DIR /srv/elixir-data
</Directory>
<Directory /usr/local/elixir/api/>
    SetHandler wsgi-script
    Require all granted
    SetEnv PYTHONIOENCODING utf-8
    SetEnv LXR_PROJ_DIR /srv/elixir-data
</Directory>
<VirtualHost *:80>
    ServerName MY_LOCAL_IP
    DocumentRoot /usr/local/elixir/http

    WSGIScriptAlias /api /usr/local/elixir/api/api.py

    WSGIDaemonProcess Elixir processes=4 threads=4 display-name=%{GROUP} python-home=/usr/local/elixir/venv/
    WSGIProcessGroup Elixir
    WSGIScriptAliasMatch "^(/(?!api).*/(source|ident|search))" /usr/local/elixir/http/web.py/$1
    WSGIScriptAliasMatch "^(/acp.*)" /usr/local/elixir/http/web.py/$1

    AllowEncodedSlashes On
    RewriteEngine on
    RewriteRule "^/$" "/linux/latest/source" [R]
</VirtualHost>
